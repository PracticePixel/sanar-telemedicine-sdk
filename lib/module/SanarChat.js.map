{"version":3,"names":["React","useEffect","useState","View","StyleSheet","Dimensions","WebView","SanarTelemedicine","width","height","get","SanarChat","props","baseUrl","setBaseUrl","notification","enable","session","CHAT_URL","chatUrl","roomName","uid","token","onMessage","event","console","log","canGoBack","data","includes","onEndFlow","styles","container","uri","flex","nativeEvent","create"],"sources":["SanarChat.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { View, StyleSheet, Dimensions } from 'react-native';\nimport WebView from 'react-native-webview';\nimport SanarTelemedicine from './SanarTelemedicine';\nconst { width, height } = Dimensions.get('window');\ninterface ISanarChat {\n    onEndFlow: () => void,\n    enable: boolean,\n    notification: any\n    appointmentId,\n    empId\n}\n\nconst SanarChat = (props: ISanarChat) => {\n    const [baseUrl, setBaseUrl] = useState('');\n    const { notification } = props;\n    useEffect(() => {\n        if (props.enable) {\n            if (SanarTelemedicine.session) {\n                const CHAT_URL = `${SanarTelemedicine.session.chatUrl}/${notification.roomName}/${notification.uid}?token=${SanarTelemedicine.session.token}`;\n                setBaseUrl(CHAT_URL);\n            }\n        }\n    })\n    const onMessage = event => {\n        console.log(baseUrl);\n        if ((!event.canGoBack && event.data && event.data.includes('home')) || (event.canGoBack && event.data && event.data.includes('home'))) {\n            setBaseUrl('');\n            props.onEndFlow();\n        }\n    }\n\n    if (!props.enable) {\n        return (null);\n    }\n    return (\n        <View style={styles.container}>\n            <WebView\n                source={{\n                    uri: baseUrl,\n                }}\n                style={{ flex: 1 }}\n                // incognito\n                onMessage={(event) => onMessage(event.nativeEvent)}\n                injectedJavaScript={`\n                    (function() {\n                        function wrap(fn) {\n                        return function wrapper() {\n                            var res = fn.apply(this, arguments);\n                            window.ReactNativeWebView.postMessage(window.location.href);\n                            return res;\n                        }\n                        }\n                        history.pushState = wrap(history.pushState);\n                        history.replaceState = wrap(history.replaceState);\n                        history.go = wrap(history.go);\n                        window.addEventListener('popstate', function() {\n                            window.ReactNativeWebView.postMessage('navigationStateChange');\n                        });\n                    })();\n                    true;\n                `}\n            />\n        </View>\n    );\n}\n\nexport default SanarChat;\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        height: height,\n        width: width,\n    }\n});"],"mappings":"AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,IAAT,EAAeC,UAAf,EAA2BC,UAA3B,QAA6C,cAA7C;AACA,OAAOC,OAAP,MAAoB,sBAApB;AACA,OAAOC,iBAAP,MAA8B,qBAA9B;AACA,MAAM;EAAEC,KAAF;EAASC;AAAT,IAAoBJ,UAAU,CAACK,GAAX,CAAe,QAAf,CAA1B;;AASA,MAAMC,SAAS,GAAIC,KAAD,IAAuB;EACrC,MAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBZ,QAAQ,CAAC,EAAD,CAAtC;EACA,MAAM;IAAEa;EAAF,IAAmBH,KAAzB;EACAX,SAAS,CAAC,MAAM;IACZ,IAAIW,KAAK,CAACI,MAAV,EAAkB;MACd,IAAIT,iBAAiB,CAACU,OAAtB,EAA+B;QAC3B,MAAMC,QAAQ,GAAI,GAAEX,iBAAiB,CAACU,OAAlB,CAA0BE,OAAQ,IAAGJ,YAAY,CAACK,QAAS,IAAGL,YAAY,CAACM,GAAI,UAASd,iBAAiB,CAACU,OAAlB,CAA0BK,KAAM,EAA5I;QACAR,UAAU,CAACI,QAAD,CAAV;MACH;IACJ;EACJ,CAPQ,CAAT;;EAQA,MAAMK,SAAS,GAAGC,KAAK,IAAI;IACvBC,OAAO,CAACC,GAAR,CAAYb,OAAZ;;IACA,IAAK,CAACW,KAAK,CAACG,SAAP,IAAoBH,KAAK,CAACI,IAA1B,IAAkCJ,KAAK,CAACI,IAAN,CAAWC,QAAX,CAAoB,MAApB,CAAnC,IAAoEL,KAAK,CAACG,SAAN,IAAmBH,KAAK,CAACI,IAAzB,IAAiCJ,KAAK,CAACI,IAAN,CAAWC,QAAX,CAAoB,MAApB,CAAzG,EAAuI;MACnIf,UAAU,CAAC,EAAD,CAAV;MACAF,KAAK,CAACkB,SAAN;IACH;EACJ,CAND;;EAQA,IAAI,CAAClB,KAAK,CAACI,MAAX,EAAmB;IACf,OAAQ,IAAR;EACH;;EACD,oBACI,oBAAC,IAAD;IAAM,KAAK,EAAEe,MAAM,CAACC;EAApB,gBACI,oBAAC,OAAD;IACI,MAAM,EAAE;MACJC,GAAG,EAAEpB;IADD,CADZ;IAII,KAAK,EAAE;MAAEqB,IAAI,EAAE;IAAR,CAJX,CAKI;IALJ;IAMI,SAAS,EAAGV,KAAD,IAAWD,SAAS,CAACC,KAAK,CAACW,WAAP,CANnC;IAOI,kBAAkB,EAAG;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EAxBY,EADJ,CADJ;AA8BH,CApDD;;AAsDA,eAAexB,SAAf;AAEA,MAAMoB,MAAM,GAAG3B,UAAU,CAACgC,MAAX,CAAkB;EAC7BJ,SAAS,EAAE;IACPE,IAAI,EAAE,CADC;IAEPzB,MAAM,EAAEA,MAFD;IAGPD,KAAK,EAAEA;EAHA;AADkB,CAAlB,CAAf"}